package scoin

import scoin._
import utest._
import scodec.bits.ByteVector
import Crypto._
object Musig2Test extends TestSuite {
  // tests and algorithms mostly from
  // https://github.com/jonasnick/bips/blob/musig2-squashed/bip-musig2.mediawiki
  val tests = Tests {
    test("musig2 - lexographic key sorting") {
      val pubkeys = List(
        "02DD308AFEC5777E13121FA72B9CC1B7CC0139715309B086C960E18FD969774EB8",
        "02F9308A019258C31049344F85F89D5229B531C845836F99B08601F113BCE036F9",
        "03DFF1D77F2A671C5F36183726DB2341BE58FEAE1DA2DECED843240F7B502BA659",
        "023590A94E768F8E1815C2F24B4D80A8E3149316C3518CE7B7AD338368D038CA66",
        "02DD308AFEC5777E13121FA72B9CC1B7CC0139715309B086C960E18FD969774EB8"
      ).map(i => PublicKey(ByteVector.fromValidHex(i)))

      val sorted_pubkeys = List(
        "023590A94E768F8E1815C2F24B4D80A8E3149316C3518CE7B7AD338368D038CA66",
        "02DD308AFEC5777E13121FA72B9CC1B7CC0139715309B086C960E18FD969774EB8",
        "02DD308AFEC5777E13121FA72B9CC1B7CC0139715309B086C960E18FD969774EB8",
        "02F9308A019258C31049344F85F89D5229B531C845836F99B08601F113BCE036F9",
        "03DFF1D77F2A671C5F36183726DB2341BE58FEAE1DA2DECED843240F7B502BA659"
      ).map(i => PublicKey(ByteVector.fromValidHex(i)))

      assert((Musig2.keySort(pubkeys)) == sorted_pubkeys)
    }
  }
}